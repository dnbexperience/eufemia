"use strict";(self.webpackChunkdnb_design_system_portal=self.webpackChunkdnb_design_system_portal||[]).push([[23144],{30767:function(e,s,n){n.r(s);var a=n(52322),r=n(45392);function i(e){const s=Object.assign({h1:"h1",h2:"h2",p:"p",code:"code",pre:"pre",a:"a",h3:"h3",ul:"ul",li:"li",h4:"h4"},(0,r.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{children:"Frequently Asked Questions (FAQ)"}),"\n",(0,a.jsx)(s.h2,{children:"How to enable lint-staged?"}),"\n",(0,a.jsxs)(s.p,{children:["Create a file called ",(0,a.jsx)(s.code,{children:".env.local"})," in the root of the repo (side-by-side to the .git folder), and put ",(0,a.jsx)(s.code,{children:"LINT_STAGED=1"})," inside:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# File: .env.local\nLINT_STAGED=1\n"})}),"\n",(0,a.jsx)(s.h2,{children:"Dependency issues"}),"\n",(0,a.jsx)(s.h2,{children:"Babel"}),"\n",(0,a.jsxs)(s.p,{children:["Due to this bug: ",(0,a.jsx)(s.a,{href:"https://github.com/babel/babel/issues/11394",children:"https://github.com/babel/babel/issues/11394"})," we add ",(0,a.jsx)(s.code,{children:".png,.snap"})," so they not get copied: ",(0,a.jsx)(s.code,{children:"--extensions '.js,.ts,.tsx,.png,.snap'"})]}),"\n",(0,a.jsx)(s.h3,{children:"Yarn PnP"}),"\n",(0,a.jsxs)(s.p,{children:["Eufemia uses yarn with ",(0,a.jsx)(s.code,{children:"node_modules"}),"."]}),"\n",(0,a.jsx)(s.p,{children:"When switching over to Yarn PnP, there are some issues:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Storybook:","\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"ERROR in eufemia/.yarn/__virtual__/@dnb-eufemia-virtual-761b82657c/1/packages/dnb-eufemia/src/components/slider/style/dnb-range.scss (eufemia/.yarn/__virtual__/css-loader-virtual-37c5c374e4/0/cache/css-loader-npm-5.2.7-e1e8b8d16f-fb0742b30a.zip/node_modules/css-loader/dist/cjs.js!eufemia/.yarn/__virtual__/sass-loader-virtual-577853f541/0/cache/sass-loader-npm-10.2.0-91ed64638b-d53212e5d1.zip/node_modules/sass-loader/dist/cjs.js!eufemia/.yarn/__virtual__/@dnb-eufemia-virtual-761b82657c/1/packages/dnb-eufemia/src/components/slider/style/dnb-range.scss)\nModule build failed (from eufemia/.yarn/__virtual__/sass-loader-virtual-577853f541/0/cache/sass-loader-npm-10.2.0-91ed64638b-d53212e5d1.zip/node_modules/sass-loader/dist/cjs.js):\nSassError: File to import not found or unreadable: eufemia/.yarn/__virtual__/@dnb-eufemia-virtual-761b82657c/1/packages/dnb-eufemia/src/style/components/imports.scss.\n        on line 6 of ../../.yarn/__virtual__/@dnb-eufemia-virtual-761b82657c/1/packages/dnb-eufemia/src/components/slider/style/dnb-range.scss\n>> @import '../../../style/components/imports.scss';\n"})}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["Gatsby","\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"gatsby-plugin-mdx tried to access mkdirp, but it isn't declared in its dependencies; this makes the require call ambiguous and unsound.\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{children:"Gatsby v4"}),"\n",(0,a.jsxs)(s.p,{children:["In order to ensure ",(0,a.jsx)(s.code,{children:"defaults and supports es6-module"})," is not targeting IE11, we run a newer version of ",(0,a.jsx)(s.code,{children:"browserslist"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-json",children:'{\n  "resolutions": {\n    "gatsby/browserslist": "4.21.4"\n  }\n}\n'})}),"\n",(0,a.jsxs)(s.p,{children:["Gatsby v4 uses socket.io v3 that has an ",(0,a.jsx)(s.a,{href:"https://github.com/socketio/socket.io/issues/3838",children:"issue"})," when running all visual tests in a batch locally on a development build. To mitigate it, we have installed a newer version of socket.io:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-json",children:'{\n  "resolutions": {\n    "gatsby/socket.io": "4.6.1"\n  }\n}\n'})}),"\n",(0,a.jsx)(s.h3,{children:"svg2vectordrawable"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"svg2vectordrawable"})," uses an very old version of svgo that did not work with newer versions of Node.js."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-json",children:'{\n  "resolutions": {\n    "svg2vectordrawable/svgo": "2.3.0"\n  }\n}\n'})}),"\n",(0,a.jsx)(s.h2,{children:"MDX v2"}),"\n",(0,a.jsxs)(s.p,{children:["In MDX v1 the Portal used an MDX template (",(0,a.jsx)(s.code,{children:"./templates/mdx.js"}),") with the ",(0,a.jsx)(s.code,{children:"createPage"}),' API. This is currently not the case anymore.\nInstead, the "PortalLayout" is used to wrap ',(0,a.jsx)(s.code,{children:".mdx"})," pages inside the ",(0,a.jsx)(s.code,{children:"wrapPageElement"})," API.\nThis is due to the ",(0,a.jsx)(s.code,{children:"JavaScript heap out of memory"})," error when using templates."]}),"\n",(0,a.jsx)(s.h2,{children:"Visual tests and Playwright"}),"\n",(0,a.jsxs)(s.p,{children:["Jest does start several works at the same time. When we simulate states on e.g. ToggleButton and Button – Playwright (v1.31.2) struggles to handle this. Some of the hover or focus tests will fail. To ensure Jest we never execute several workers as the same time, we set ",(0,a.jsx)(s.code,{children:"--maxWorkers=1"}),"."]}),"\n",(0,a.jsx)(s.h3,{children:"Installing screenshot browser"}),"\n",(0,a.jsx)(s.p,{children:"For running screenshot tests (visual tests), a headless Firefox browser is needed."}),"\n",(0,a.jsx)(s.p,{children:"In normal circumstances, the browser will be installed automatically via yarn install – but to either upgrade to a newer version, or to wipe out existing versions and run the install manually, you can run this commands, depending on your needs:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"yarn workspace @dnb/eufemia playwright uninstall --all\nyarn workspace @dnb/eufemia add -D @playwright/test\nyarn workspace @dnb/eufemia playwright install firefox\n\nyarn workspace dnb-design-system-portal playwright uninstall --all\nyarn workspace dnb-design-system-portal add -D @playwright/test\nyarn workspace dnb-design-system-portal playwright install firefox\n"})}),"\n",(0,a.jsx)(s.h4,{children:"Alternative install: skip authentication"}),"\n",(0,a.jsxs)(s.p,{children:["But, since Node.js and corporate proxy do not enjoy each other's company, this might\nfail with a ",(0,a.jsx)(s.code,{children:"Error: unable to get local issuer certificate"}),". In that case, your only\noption might be to disable all authentication for this command."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"NODE_TLS_REJECT_UNAUTHORIZED=0 yarn workspace @dnb/eufemia playwright install firefox\n"})}),"\n",(0,a.jsx)(s.h4,{children:"Alternative install: manually"}),"\n",(0,a.jsxs)(s.p,{children:["Or, in the very worst case, you can manually download the zip file that ",(0,a.jsx)(s.code,{children:"yarn workspace  @dnb/eufemia playwright install firefox"}),' attempts to download, and extract the file\n("Nightly" for Firefox) to the folder indicated when ',(0,a.jsx)(s.code,{children:"yarn test:screenshots"})," fails."]}),"\n",(0,a.jsx)(s.h2,{children:"How can I make faster builds?"}),"\n",(0,a.jsx)(s.p,{children:'This is only meant for "setup testing" purposes! In order to make faster local builds, you can:'}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Inside ",(0,a.jsx)(s.code,{children:"gatsby-config.js"})," rename all sourcing from ",(0,a.jsx)(s.code,{children:"/docs"})," to ",(0,a.jsx)(s.code,{children:"/docs_dummy"})]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Run ",(0,a.jsx)(s.code,{children:"yarn workspace dnb-design-system-portal build:visual-test"})]}),"\n",(0,a.jsx)(s.h2,{children:"I get Gatsby 404 Not Found on the pages I work on"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Try cleaning cache: ",(0,a.jsx)(s.code,{children:"yarn workspace dnb-design-system-portal gatsby clean"})]}),"\n",(0,a.jsxs)(s.li,{children:["Try running ",(0,a.jsx)(s.code,{children:"yarn build"})," again"]}),"\n"]})]})}s.default=function(e){void 0===e&&(e={});const{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,a.jsx)(s,Object.assign({},e,{children:(0,a.jsx)(i,e)})):i(e)}}}]);
//# sourceMappingURL=component---src-docs-contribute-faq-mdx-cd994cc396025f5bde6f.js.map