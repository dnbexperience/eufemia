"use strict";(self.webpackChunkdnb_design_system_portal=self.webpackChunkdnb_design_system_portal||[]).push([[48338,4117,35641],{85753:function(e,n,r){r.r(n);var s=r(52322),o=r(45392),i=r(69403),l=r(94929),a=r(13442);function d(e){const n=Object.assign({h1:"h1",p:"p",a:"a",pre:"pre",code:"code",h2:"h2",h3:"h3",hr:"hr"},(0,o.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{children:"Create your own component"}),"\n",(0,s.jsx)(n.p,{children:"Eufemia Forms contains helper fields and tools so you can declaratively create interactive form components that flawlessly integrates between existing data and your custom form components."}),"\n",(0,s.jsxs)(n.p,{children:["By using the building blocks for field components, you save development time, and at the same time ensure that local, custom components work similarly, and fit into the setup with ",(0,s.jsx)(n.a,{href:"/uilib/extensions/forms/base-fields/",children:"the standardized field components"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import {\n  FieldBlock,\n  useDataValue,\n  Iterate,\n  DataContext,\n} from '@dnb/eufemia/extensions/forms'\n"})}),"\n",(0,s.jsx)(n.h2,{children:"FieldBlock and useDataValue"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"FieldBlock"})," component and the ",(0,s.jsx)(n.code,{children:"useDataValue"})," hook are the basis for all field components in Eufemia Forms."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"FieldBlock"})," provides a standardized way to display labels, error messages and other surrounding elements in a consistent manner."]}),"\n",(0,s.jsxs)(n.p,{children:["While ",(0,s.jsx)(n.code,{children:"useDataValue"})," provides a standardized way to handle data flow, validation and error messages in a consistent manner."]}),"\n",(0,s.jsx)(l.CreateBasicFieldComponent,{}),"\n",(0,s.jsx)(n.h3,{children:"More details"}),"\n",(0,s.jsxs)(n.p,{children:["This example shows a custom component. The ",(0,s.jsx)(n.code,{children:"useDataValue"})," hook receives the props and adds extra properties to standardize field behavior. These includes ",(0,s.jsx)(n.code,{children:"handleFocus"}),", ",(0,s.jsx)(n.code,{children:"handleChange"}),", and ",(0,s.jsx)(n.code,{children:"handleBlur"}),' functions. Even if the field components has external callbacks like "onChange", these won\'t be altered. The "handle" variants simplifies your code.']}),"\n",(0,s.jsx)(n.h3,{children:"The example explained"}),"\n",(0,s.jsxs)(n.p,{children:["Using these two form helpers in your field component triggers several automatic processes. These include timely validation checks, syncing value changes with the ",(0,s.jsx)(n.code,{children:"DataContext"}),", coordinating error messages across multiple fields, and preventing premature error displays while the user is editing the field."]}),"\n",(0,s.jsxs)(n.p,{children:["Keep in mind, you can customize the behavior of ",(0,s.jsx)(n.code,{children:"useDataValue"})," and other helper functions to make the component work exactly as you want."]}),"\n",(0,s.jsx)(n.h3,{children:"Your own validation"}),"\n",(0,s.jsxs)(n.p,{children:["If you need custom validation that can't use the built-in JSON Schema or a derivative validator (like in the example above), you can create your own logic. Then, pass the result as an ",(0,s.jsx)(n.code,{children:"error"})," prop to ",(0,s.jsx)(n.code,{children:"FieldBlock"}),". All direct props override standard handling, giving you full control over your component."]}),"\n",(0,s.jsx)(n.h3,{children:"Customized even further"}),"\n",(0,s.jsxs)(n.p,{children:["If you need something that looks even more different than the usual fields, you can drop ",(0,s.jsx)(n.code,{children:"FieldBlock"})," and display surrounding elements in other ways â€“ but still get all the help of a data flow logic, such as ",(0,s.jsx)(n.code,{children:"useDataValue"})," offers."]}),"\n",(0,s.jsx)(n.p,{children:"Here follows an example that retrieves data from a surrounding DataContext, and creates a composite field based on other components from Eufemia:"}),"\n",(0,s.jsx)(l.CreateComposedFieldComponent,{}),"\n",(0,s.jsx)(n.h2,{children:"Layout"}),"\n",(0,s.jsxs)(n.p,{children:["When building your custom form components, preferably use the ",(0,s.jsx)(n.a,{href:"/uilib/layout",children:"Layout"})," component."]}),"\n",(0,s.jsx)(n.h3,{children:"Width definitions"}),"\n",(0,s.jsxs)(n.p,{children:["These are the official sizes you can use when ",(0,s.jsx)(n.a,{href:"/uilib/extensions/forms/create-component/",children:"creating your own form fields"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:":root {\n  --forms-field-width--small: 5rem;\n  --forms-field-width--medium: 11rem;\n  --forms-field-width--large: 21rem;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also use a ",(0,s.jsx)(n.a,{href:"/uilib/extensions/forms/create-component/FieldBlock/",children:"FieldBlock"})," and provide a ",(0,s.jsx)(n.code,{children:"width"})," prop with a value of either ",(0,s.jsx)(n.code,{children:"small"}),", ",(0,s.jsx)(n.code,{children:"medium"})," or ",(0,s.jsx)(n.code,{children:"large"})," and use it as a sized wrapper."]}),"\n",(0,s.jsx)(n.h2,{children:"Components"}),"\n",(0,s.jsx)(i.default,{}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{children:"Hooks"}),"\n",(0,s.jsx)(a.default,{})]})}n.default=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,o.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(d,e)})):d(e)}},13442:function(e,n,r){r.r(n);var s=r(52322),o=r(45392);function i(e){const n=Object.assign({h3:"h3",p:"p",code:"code",pre:"pre",h4:"h4",ul:"ul",li:"li",strong:"strong",a:"a",h5:"h5",ol:"ol"},(0,o.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{children:"useDataValue"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"useDataValue"})," hook standardize handling of the value flow for a single consumer component representing one data point. It holds error state, hides it while the field is in focus, connects to surrounding ",(0,s.jsx)(n.code,{children:"DataContext"})," (if present) and other things that all field or value components needs to do. By implementing custom field or value components and passing the received props through ",(0,s.jsx)(n.code,{children:"useDataValue"}),", all these features work the same way as other field or value components, and you only need to implement the specific unique features of that component."]}),"\n",(0,s.jsx)(n.p,{children:"How to use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { value } = useDataValue(componentProps)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Advanced usage:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const {\n  // Return Parameters:\n  value,\n  onChange,\n  onFocus,\n  onBlur,\n  error,\n  hasError,\n  isChanged,\n  setHasFocus,\n\n  // Component Properties\n  ...rest\n} = useDataValue({\n  // Your Component Properties:\n  ...componentProps,\n\n  // Internal Properties, listed down below:\n  required,\n  errorMessages,\n})\n"})}),"\n",(0,s.jsx)(n.h4,{children:"Internal Properties"}),"\n",(0,s.jsx)(n.p,{children:"All properties are optional and can be used as needed. These properties can be provided as part of your component properties."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"value"})," the input value (string)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"emptyValue"})," defines what value is considered to be empty. Defaults to ",(0,s.jsx)(n.code,{children:"undefined"}),". But an empty string is also validated when required is true."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"path"})," the JSON pointer that defines the entry name/key in the data structure."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Validation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"required"})," if true, it will call ",(0,s.jsx)(n.code,{children:"validateRequired"})," for validation."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"schema"})," or ",(0,s.jsx)(n.code,{children:"pattern"})," for JSON schema validation powered by ",(0,s.jsx)(n.a,{href:"https://ajv.js.org/",children:"ajv"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validator"})," your custom validation function. It will run on every keystroke."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validateRequired"})," does allow you to provide a custom logic for how the ",(0,s.jsx)(n.code,{children:"required"})," prop should validate."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onBlurValidator"})," your custom validation function. It will run on a ",(0,s.jsx)(n.code,{children:"handleBlur()"})," call. Use it over ",(0,s.jsx)(n.code,{children:"validator"})," for validations with side-effects."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validateInitially"})," in order to show an error without a change and blur event. Used for rare cases."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validateUnchanged"})," in order to validate without a change and blur event. Used for rare cases."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"continuousValidation"})," in order to validate without a focus event beforehand. Used for rare cases."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Error"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error"})," object like ",(0,s.jsx)(n.code,{children:"FormError"})," that includes the string to display or an object with the key ",(0,s.jsx)(n.code,{children:"validationRule"}),". More info down below."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"errorMessages"})," object with your custom messages, where each key represents a ",(0,s.jsx)(n.code,{children:"validationRule"}),". More info down below."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{children:"Return Parameters"}),"\n",(0,s.jsx)(n.p,{children:"It returns all of the given component properties, in addition to these:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"value"})," the output value."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"id"})," creates a memorized id."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"dataContext"})," the internal shared data context."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error"})," the error object, in case an error is invoked. Will skip returning the error object, if the hook is used in a nested ",(0,s.jsx)(n.a,{href:"/uilib/extensions/forms/create-component/FieldBlock/",children:"FieldBlock"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hasError"})," will return true in case of an error, even if the hook is nested in a ",(0,s.jsx)(n.code,{children:"FieldBlock"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isChanged"})," returns ",(0,s.jsx)(n.code,{children:"true"})," if the value has changed with e.g. ",(0,s.jsx)(n.code,{children:"handleChange"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setHasFocus"})," accepts a boolean as value. When called, it will update the internal logic - for event handling and validation. Will re-render the React Hook and its outer component."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onFocus"})," event handler to assign to a form element."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onBlur"})," event handler to assign to a form element."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onChange"})," event handler to assign to a form element."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{children:"Custom validateRequired"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const validateRequired = (\n  value: Value,\n  { emptyValue, required, isChanged },\n) => {\n  return required && value === emptyValue\n    ? new FormError('The value is required', {\n        validationRule: 'required',\n      })\n    : undefined\n}\n\nconst { error, hasError } = useDataValue({\n  value: undefined,\n  required: true,\n  validateInitially: true,\n  validateRequired,\n  errorMessages: {\n    required: 'Show this when \"required\" fails!',\n  },\n})\n"})}),"\n",(0,s.jsx)(n.h5,{children:"Validation order"}),"\n",(0,s.jsx)(n.p,{children:"During validation, the different APIs do have a prioritization order and will stop processing further when they match:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"required"})," prop"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"schema"})," prop (including ",(0,s.jsx)(n.code,{children:"pattern"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"validator"})," prop"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{children:"Error handling"}),"\n",(0,s.jsx)(n.p,{children:"Validation and error-handling is tight coupled together. When a validation fails, you may use the error-object to handle and show the failures/statuses."}),"\n",(0,s.jsxs)(n.p,{children:["To generate the error-object, ",(0,s.jsx)(n.code,{children:"FormError"})," is used. You can use it as well:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import { FormError } from \'@dnb/eufemia/extensions/forms\'\nrender(\n  <Field.String\n    label="Label"\n    warning={new FormError("I\'m a warning too...")}\n  />,\n)\n'})}),"\n",(0,s.jsxs)(n.p,{children:["But when you handle errors via ",(0,s.jsx)(n.code,{children:"useDataValue"}),", you may rather provide an object with messages, which will be used to display the error:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { error, hasError } = useDataValue({\n  required: true,\n  errorMessages: {\n    required: 'Show this when \"required\" fails!',\n  },\n  ...componentProps,\n})\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In order to invoke an error without a change and blur event, you can use ",(0,s.jsx)(n.code,{children:"validateInitially"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const { error, hasError } = useDataValue({\n  value: undefined,\n  required: true,\n  validateInitially: true,\n  errorMessages: {\n    required: 'Show this when \"required\" fails!',\n  },\n})\n"})}),"\n",(0,s.jsx)(n.h4,{children:"Event handlers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"handleFocus()"})," to call the ",(0,s.jsx)(n.code,{children:"onFocus"})," event."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"handleBlur()"})," to call the ",(0,s.jsx)(n.code,{children:"onBlur"})," event."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"handleChange(value)"})," to call the ",(0,s.jsx)(n.code,{children:"onChange"})," event. Will update/change the internal value and re-render the React Hook, so will the outer component too."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"handleChange(value, (additionalArgs = null))\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"updateValue(value)"})," to update/change the internal value, without calling any events."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"forceUpdate()"})," to re-render the React Hook along with the outer component."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{children:"Value transformers"}),"\n",(0,s.jsx)(n.p,{children:"The transformers are hooks to transform the value on different stages."}),"\n",(0,s.jsxs)(n.p,{children:["They should return a transformed value: ",(0,s.jsx)(n.code,{children:"(value) => value"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"toInput"})," transforms the value before it gets returned as the ",(0,s.jsx)(n.code,{children:"value"}),":"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"fromInput"})," transforms the value given by ",(0,s.jsx)(n.code,{children:"handleChange"})," before it is used in the further process flow. Use it to destruct the value form the original event object."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"toEvent"})," transforms the internal value before it gets returned by even callbacks such as ",(0,s.jsx)(n.code,{children:"onChange"}),", ",(0,s.jsx)(n.code,{children:"onFocus"})," and ",(0,s.jsx)(n.code,{children:"onBlur"}),". The second parameter returns the event type: ",(0,s.jsx)(n.code,{children:"onChange"}),", ",(0,s.jsx)(n.code,{children:"onFocus"}),", ",(0,s.jsx)(n.code,{children:"onBlur"})," or ",(0,s.jsx)(n.code,{children:"onBlurValidator"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"fromExternal"})," transforms the given props ",(0,s.jsx)(n.code,{children:"value"})," before any other step gets entered."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"transformValue"})," transforms the value given by ",(0,s.jsx)(n.code,{children:"handleChange"})," after ",(0,s.jsx)(n.code,{children:"fromInput"})," and before ",(0,s.jsx)(n.code,{children:"updateValue"})," and ",(0,s.jsx)(n.code,{children:"toEvent"}),". The second parameter returns the current value"]}),"\n"]}),"\n"]})]})}n.default=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,o.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(i,e)})):i(e)}},69403:function(e,n,r){r.r(n),r.d(n,{default:function(){return l}});var s=r(68270),o=r(75440),i=r(52322);function l(){const{allMdx:{edges:e}}=(0,s.useStaticQuery)("1487441482");return(0,i.jsx)(o.Z,{edges:e})}}}]);
//# sourceMappingURL=component---src-docs-uilib-extensions-forms-create-component-mdx-bceec0191013eeca523a.js.map