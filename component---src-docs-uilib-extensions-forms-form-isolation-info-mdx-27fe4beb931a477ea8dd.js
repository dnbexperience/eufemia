"use strict";(self.webpackChunkdnb_design_system_portal=self.webpackChunkdnb_design_system_portal||[]).push([[29125],{20951:function(e,n,o){o.r(n);var t=o(31085),r=o(71184);function s(e){const n=Object.assign({h2:"h2",pre:"pre",code:"code",p:"p",a:"a",h3:"h3",ul:"ul",li:"li",strong:"strong"},(0,r.R)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{children:"Import"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { Form } from '@dnb/eufemia/extensions/forms'\nrender(<Form.Isolation />)\n"})}),"\n",(0,t.jsx)(n.h2,{children:"Description"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Form.Isolation"})," lets you isolate parts of your form so data and validations are not shared between the ",(0,t.jsx)(n.code,{children:"Form.Handler"})," until you want to."]}),"\n",(0,t.jsxs)(n.p,{children:["It's a provider that lets you provide a ",(0,t.jsx)(n.code,{children:"schema"})," or ",(0,t.jsx)(n.code,{children:"data"})," very similar to what the ",(0,t.jsx)(n.a,{href:"/uilib/extensions/forms/Form/Handler/",children:"Form.Handler"})," component does."]}),"\n",(0,t.jsx)(n.h3,{children:"Good to know"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["It needs to be used inside of a ",(0,t.jsx)(n.code,{children:"Form.Handler"})," component."]}),"\n",(0,t.jsxs)(n.li,{children:["All fields inside need to validate successfully before the isolated data can be committed, just like the ",(0,t.jsx)(n.code,{children:"Form.Handler"})," does before submitting."]}),"\n",(0,t.jsxs)(n.li,{children:["Input fields are prevented from submitting the form when pressing enter. Pressing enter on input fields will commit the isolated data to the ",(0,t.jsx)(n.code,{children:"Form.Handler"})," context instead."]}),"\n",(0,t.jsxs)(n.li,{children:["You can provide a ",(0,t.jsx)(n.code,{children:"schema"}),", ",(0,t.jsx)(n.code,{children:"data"})," or ",(0,t.jsx)(n.code,{children:"defaultData"})," like you would do with the ",(0,t.jsx)(n.code,{children:"Form.Handler"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["You can also provide ",(0,t.jsx)(n.code,{children:"data"})," or ",(0,t.jsx)(n.code,{children:"defaultData"})," to the ",(0,t.jsx)(n.code,{children:"Form.Handler"})," component. If not given on the ",(0,t.jsx)(n.code,{children:"Form.Isolation"})," component, this will define the data that will be used for the isolated data."]}),"\n",(0,t.jsxs)(n.li,{children:["Using ",(0,t.jsx)(n.code,{children:"Form.Isolation"})," inside of a ",(0,t.jsx)(n.code,{children:"Form.Section"})," is supported."]}),"\n",(0,t.jsxs)(n.li,{children:["If the user enters data without committing it to the outer context, that data will be lost when navigating to another step in the Wizard. To prevent this, you can use the ",(0,t.jsx)(n.code,{children:"preventUncommittedChanges"})," property on Form.Isolation. When enabled, it will display an error message if the user tries to proceed without committing their changes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"onChange"})," on the ",(0,t.jsx)(n.code,{children:"Form.Handler"})," will be called when the isolated data gets committed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"onChange"})," on the ",(0,t.jsx)(n.code,{children:"Form.Isolation"})," will be called on every change of the isolated data. Use ",(0,t.jsx)(n.code,{children:"onCommit"})," to get the data that gets committed."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{children:"Usage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Form, Field } from \'@dnb/eufemia/extensions/forms\'\n\nexport function MyForm(props) {\n  return (\n    <Form.Handler\n      defaultData={{ isolated: \'Isolated\', regular: \'Regular\' }}\n    >\n      <Form.Isolation resetDataAfterCommit>\n        <Field.String label="Isolated" path="/isolated" />\n        <Form.Isolation.CommitButton />\n      </Form.Isolation>\n\n      <Field.String label="Regular" path="/regular" />\n      <Form.SubmitButton />\n    </Form.Handler>\n  )\n}\n'})}),"\n",(0,t.jsx)(n.h2,{children:"TypeScript support"}),"\n",(0,t.jsx)(n.p,{children:"You can define the TypeScript type structure for your data like so:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { Form, Field } from '@dnb/eufemia/extensions/forms'\n\ntype IsolationData = {\n  persons: Array<{ name: string }>\n  newPerson: Array<{ name: string }>\n}\n\nfunction MyForm() {\n  return (\n    <Form.Isolation<IsolationData>\n      onCommit={(data) => {\n        data // <-- is of type IsolationData\n      }}\n      transformOnCommit={(isolatedData, handlerData) => {\n        return {\n          ...handlerData,\n          persons: [...handlerData.persons, isolatedData.newPerson],\n        }\n      }}\n    >\n      ...\n    </Form.Isolation>\n  )\n}\n"})}),"\n",(0,t.jsx)(n.h2,{children:"Commit the data to the form"}),"\n",(0,t.jsxs)(n.p,{children:["You can either use the ",(0,t.jsx)(n.code,{children:"Form.Isolation.CommitButton"})," or provide a custom ref handler you can use (call) when you want to commit the data to the ",(0,t.jsx)(n.code,{children:"Form.Handler"})," context:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Form, Field, JSONSchema } from \'@dnb/eufemia/extensions/forms\'\n\nfunction MyForm() {\n  const commitHandleRef = React.useRef<() => void>()\n\n  return (\n    <Form.Handler>\n      <Form.Isolation commitHandleRef={commitHandleRef}>\n        <Field.PhoneNumber path="/phoneNumber" />\n        <Button text="Submit" onClick={commitHandleRef.current} />\n      </Form.Isolation>\n    </Form.Handler>\n  )\n}\n\nrender(<MyForm />)\n'})}),"\n",(0,t.jsx)(n.h2,{children:"Prevent the form from being submitted"}),"\n",(0,t.jsxs)(n.p,{children:["To prevent the ",(0,t.jsx)(n.a,{href:"/uilib/extensions/forms/Form/Handler/",children:"Form.Handler"})," from being submitted when there are fields with errors inside the Isolation, you can use the ",(0,t.jsx)(n.code,{children:"bubbleValidation"})," property."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Form, Field } from \'@dnb/eufemia/extensions/forms\'\n\nrender(\n  <Form.Handler>\n    <Form.Isolation bubbleValidation>\n      <Field.String label="Required field" path="/isolated" required />\n      <Form.Isolation.CommitButton />\n    </Form.Isolation>\n  </Form.Handler>\n)\n'})}),"\n",(0,t.jsx)(n.h2,{children:"Schema support"}),"\n",(0,t.jsxs)(n.p,{children:["You can also use a ",(0,t.jsx)(n.code,{children:"schema"})," to define the properties of the nested fields."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Using Zod schemas"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'import { Form, Field, z } from \'@dnb/eufemia/extensions/forms\'\n\nconst MySection = (props) => {\n  return (\n    <Form.Section {...props}>\n      <Field.PhoneNumber path="/phoneNumber" />\n    </Form.Section>\n  )\n}\n\nconst schema = z.object({\n  phoneNumber: z.string().regex(/^[0-9]{10}$/),\n})\n\nrender(\n  <Form.Handler>\n    <Form.Isolation schema={schema}>\n      <Field.PhoneNumber path="/phoneNumber" />\n    </Form.Isolation>\n  </Form.Handler>\n)\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Using JSON Schema (Ajv)"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import {\n  Form,\n  Field,\n  JSONSchema,\n  makeAjvInstance,\n} from '@dnb/eufemia/extensions/forms'\n\nconst ajv = makeAjvInstance()\nconst isolatedSchema: JSONSchema = {\n  type: 'object',\n  properties: {\n    phoneNumber: {\n      type: 'string',\n      pattern: '^[0-9]{10}$',\n    },\n  },\n  required: ['phoneNumber'],\n}\n\nrender(\n  <Form.Handler ajvInstance={ajv}>\n    <Form.Isolation schema={isolatedSchema}>\n      <Field.PhoneNumber path=\"/phoneNumber\" />\n    </Form.Isolation>\n  </Form.Handler>\n)\n"})}),"\n",(0,t.jsx)(n.h2,{children:"Clear data from isolated fields"}),"\n",(0,t.jsxs)(n.p,{children:["You can clear the isolation by calling ",(0,t.jsx)(n.code,{children:"clearData"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:"import { Form, Field } from '@dnb/eufemia/extensions/forms'\n\nfunction MyForm() {\n  return (\n    <Form.Handler>\n      <Form.Isolation\n        onCommit={(data, { clearData }) => {\n          clearData()\n        }}\n      >\n        <Field.String path=\"/isolated\" />\n        <Form.Isolation.CommitButton />\n      </Form.Isolation>\n    </Form.Handler>\n  )\n}\n"})}),"\n",(0,t.jsxs)(n.h2,{children:["Reset data after commit (",(0,t.jsx)(n.code,{children:"resetDataAfterCommit"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["You can reset the isolation the user committed by using ",(0,t.jsx)(n.code,{children:"resetDataAfterCommit"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:"import { Form, Field } from '@dnb/eufemia/extensions/forms'\n\nfunction MyForm() {\n  return (\n    <Form.Handler>\n      <Form.Isolation resetDataAfterCommit>\n        <Field.String path=\"/isolated\" />\n        <Form.Isolation.CommitButton />\n      </Form.Isolation>\n    </Form.Handler>\n  )\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{children:["Define your own data reference (",(0,t.jsx)(n.code,{children:"dataReference"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["Technically, when you use ",(0,t.jsx)(n.code,{children:"preventUncommittedChanges"})," or ",(0,t.jsx)(n.code,{children:"resetDataAfterCommit"}),", the ",(0,t.jsx)(n.code,{children:"Form.Isolation"}),' will use its "initial" internal data set to create a reference. This reference is used to either compare if there is a change or to reset the data context after a commit.']}),"\n",(0,t.jsx)(n.p,{children:"But in some situations, you may need a different data set than the initial data set given at the initial render."}),"\n",(0,t.jsxs)(n.p,{children:["In order to do that you can create a ",(0,t.jsx)(n.code,{children:"dataReference"})," and pass it to the ",(0,t.jsx)(n.code,{children:"Form.Isolation"})," component and call ",(0,t.jsx)(n.code,{children:"refresh"})," on it whenever you need to update it."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:'import { Form, Field } from \'@dnb/eufemia/extensions/forms\'\n\nconst dataReference = Form.Isolation.createDataReference()\n\nfunction MyForm() {\n  useEffect(() => {\n    // When ever you want to refresh the "reset data"\n    dataReference.refresh()\n  }, [])\n\n  return (\n    <Form.Handler>\n      <Form.Isolation resetDataAfterCommit dataReference={dataReference}>\n        <Field.String path="/isolated" />\n        <Form.Isolation.CommitButton />\n      </Form.Isolation>\n    </Form.Handler>\n  )\n}\n'})}),"\n",(0,t.jsxs)(n.h2,{children:["Require the user to commit before submitting (",(0,t.jsx)(n.code,{children:"preventUncommittedChanges"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["In scenarios where you want to ensure users commit their changes before submitting or navigating to the next Wizard step, you can use the ",(0,t.jsx)(n.code,{children:"preventUncommittedChanges"})," property. This will prevent form submission (or a step change) and prompt the user to commit any uncommitted changes first."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:'import { Form, Field } from \'@dnb/eufemia/extensions/forms\'\n\nfunction MyForm() {\n  return (\n    <Form.Handler>\n      <Form.Isolation preventUncommittedChanges resetDataAfterCommit>\n        <Field.String path="/isolated" />\n        <Form.Isolation.CommitButton />\n        <Form.Isolation.ResetButton showWhen="uncommittedChangeDetected" />\n      </Form.Isolation>\n    </Form.Handler>\n  )\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:'showWhen="uncommittedChangeDetected"'}),' property ensures that the reset button is displayed only when the "prevent uncommitted changes" error is visible. This helps prevent users from resetting the form unnecessarily.']})]})}n.default=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.R)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(s,e)})):s(e)}}}]);
//# sourceMappingURL=component---src-docs-uilib-extensions-forms-form-isolation-info-mdx-27fe4beb931a477ea8dd.js.map