"use strict";(self.webpackChunkdnb_design_system_portal=self.webpackChunkdnb_design_system_portal||[]).push([[41122],{11850:function(e,n,t){var r=t(84616),o=t(2784),u=t(72779),s=t.n(u),c=t(95955),i=t.n(c),l=t(26409),a=t(37339),d=t(61890),f=t(82507),h=t(26),m=t(30392),v=t(38875),p=t(51022),x=t(58106),b=t(88069),Z=t(57039),C=t(8160),g=t(52322);function j(e){var n;const{0:t,1:u}=(0,o.useReducer)((()=>({})),{}),c=(0,o.useContext)(p.Z),j=(0,o.useContext)(x.Z),{getValue:w}=(0,C.Z)(),R=(0,o.useMemo)((()=>{const{path:n,countPath:t,countPathLimit:r=1/0,countPathTransform:o}=e;if(t){const u=w(n);let s=parseFloat(w(t));if(s>=0||(s=0),s>r&&(s=r),(null==u?void 0:u.length)!==s){const n=[];for(let e=0,t=s;e<t;e++){const t=null==u?void 0:u[e];n.push(null==o?void 0:o({value:t,index:e}))}return{...e,value:n}}}return e}),[w,e]),{path:_,value:k,withoutFlex:y,emptyValue:N,placeholder:P,handleChange:E,onChange:S,children:M}=(0,l.Z)(R),A=(0,o.useRef)([]),B=(0,o.useRef)({}),V=(0,o.useRef)({}),I=(0,o.useRef)(),F=(0,o.useRef)(k),O=(0,o.useRef)(),L=(0,o.useRef)(),T=(0,o.useRef)({}),$=null!=y?y:c||j;(0,o.useEffect)((()=>{F.current=k||[]}),[k]);const q=(0,o.useMemo)((()=>{var e;return(null!==(e=I.current||k)&&void 0!==e?e:[]).map(((e,n)=>{var t;const o=A.current[n]||(0,a.Xo)(),s=k.length>(null===(t=F.current)||void 0===t?void 0:t.length);A.current[n]||(B.current[o]=s,A.current.push(o));const c=B.current[o]||!1;return V.current[o]||(V.current[o]=c?"edit":"view"),{id:o,path:_,value:e,index:n,arrayValue:k,containerRef:O,isNew:c,containerMode:V.current[o],switchContainerMode:e=>{var n;V.current[o]=e,null===(n=B.current)||void 0===n||delete n[o],u()},handleChange:(e,t)=>{const r=(0,Z.ZP)(k);r[n]={...r[n]},i().set(r,e,t),E(r)},handlePush:e=>{L.current=!0,E([].concat((0,r.Z)(null!=k?k:[]),[e]))},handleRemove:function(e){let{keepItems:t=!1}=void 0===e?{}:e;t&&(I.current=k);const r=(0,Z.ZP)(k);r.splice(n,1),E(r)},fulfillRemove:()=>{var e,n;I.current=null,null===(e=V.current)||void 0===e||delete e[o],null===(n=B.current)||void 0===n||delete n[o];const t=A.current.indexOf(o);A.current.splice(t,1),u()},restoreOriginalValue:e=>{const t=(0,Z.ZP)(k);t[n]=e,E(t)}}}))}),[t,k,_,E]);(0,o.useMemo)((()=>{const e=null==q?void 0:q[q.length-1];null!=e&&e.isNew&&!L.current?null==S||S(k):L.current=!1}),[k,q,S]);const z={className:s()("dnb-forms-iterate","dnb-forms-section",null==e?void 0:e.className),...(0,m.W)(e),...(0,h.SR)(e),innerRef:O},D=$?o.Fragment:d.Z;return(0,g.jsx)(D,{...$?null:z,children:k===N||0===(null==e||null===(n=e.value)||void 0===n?void 0:n.length)?P:q.map((e=>{const{id:n,value:t,index:r}=e,u=T.current[n]=T.current[n]||(0,o.createRef)(),s=e=>"function"==typeof e?e(t,r):e,c={...e,elementRef:u},i=Array.isArray(M)?M.map((e=>s(e))):s(M);return $?(0,g.jsx)(v.Z.Provider,{value:c,children:(0,g.jsx)(b.Z,{children:i})},`element-${n}`):(0,g.jsx)(f.Z,{className:"dnb-forms-iterate__element",tabIndex:-1,innerRef:u,children:(0,g.jsx)(v.Z.Provider,{value:c,children:(0,g.jsx)(b.Z,{children:i})})},`element-${n}`)}))})}j._supportsSpacingProps=!0,n.Z=j},49414:function(e,n,t){t.r(n),t.d(n,{AnimatedContainer:function(){return z},Array:function(){return C.Z},ArrayPushButton:function(){return U},ArrayRemoveElementButton:function(){return Y},Count:function(){return G},EditContainer:function(){return I},IterateElementContext:function(){return i.Z},PushButton:function(){return m},RemoveButton:function(){return Z},Toolbar:function(){return V},ViewContainer:function(){return $},count:function(){return K},useCount:function(){return Q}});var r=t(84616),o=t(2784),u=t(72779),s=t.n(u),c=t(96844),i=t(38875),l=t(26409),a=t(27439),d=t(93206),f=t(52322);function h(e){const n=(0,o.useContext)(i.Z),{handlePush:t}=null!=n?n:{},{pushValue:u,className:h,...m}=e,v=(0,a.wH)(m),{value:p,handleChange:x,children:b}=(0,l.Z)(m);if(void 0!==p&&!Array.isArray(p))throw new Error("PushButton received a non-array value");const Z=(0,o.useCallback)((()=>{const e="function"==typeof u?u(p):u;t?t(e):x([].concat((0,r.Z)(null!=p?p:[]),[e]))}),[p,u,t,x]);return(0,f.jsx)(c.Z,{className:s()("dnb-forms-iterate-push-button",h),variant:"secondary",icon:d.Z,icon_position:"left",on_click:Z,...v,children:b})}h._supportsSpacingProps=!0;var m=h,v=t(67863);var p=(0,o.createContext)(null),x=t(42277);function b(e){const n=(0,o.useContext)(i.Z),{handleRemove:t}=null!=n?n:{};if(!n)throw new Error("RemoveButton must be inside an Iterate.Array");const{className:r,...u}=e,{children:d,text:h}=(0,l.Z)(u),m=(0,a.wH)(u),b=(0,v.Z)().RemoveButton,Z=h||d||b.text,C=(0,o.useContext)(p),{handleRemoveBlock:g}=null!=C?C:{},j=(0,o.useCallback)((()=>{g?g():t()}),[t,g]);return(0,f.jsx)(c.Z,{className:s()("dnb-forms-iterate-remove-element-button",r),variant:Z?"tertiary":"secondary",icon:x.Z,icon_position:"left",on_click:j,...m,children:Z})}b._supportsSpacingProps=!0;var Z=b,C=t(11850),g=t(37339),j=t(58984),w=t(79583),R=t(89751),_=t(72691),k=t(88952),y=t(81011);function N(){const{restoreOriginalValue:e,switchContainerMode:n,containerMode:t,arrayValue:r,index:u,isNew:s}=(0,o.useContext)(i.Z)||{},{hasVisibleError:l}=(0,o.useContext)(y.Z)||{},a=(0,v.Z)().IterateEditContainer,d=(0,o.useRef)(),h=function(e){let{isNew:n,containerMode:t}=e;const r=(0,o.useRef)(n);return(0,o.useEffect)((()=>{"view"===t&&(r.current=!1)}),[n,t]),r.current}({isNew:s,containerMode:t}),{0:m,1:p}=(0,o.useState)(!1);(0,o.useEffect)((()=>{"edit"!==t||d.current||(d.current=null==r?void 0:r[u]),"view"===t&&(d.current=null)}),[r,t,u]);const x=(0,o.useCallback)((()=>{d.current&&(null==e||e(d.current)),p(!1),null==n||n("view")}),[e,n]),b=(0,o.useCallback)((()=>{l?p(!0):(p(!1),null==n||n("view"))}),[l,n]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(w.ZP,{show:m&&l,no_animation:!1,children:a.errorInSection}),(0,f.jsxs)(R.Z,{gap:"large",children:[(0,f.jsx)(c.Z,{variant:"tertiary",icon:_.Z,icon_position:"left",on_click:b,children:a.doneButton}),h?(0,f.jsx)(Z,{text:a.removeButton}):(0,f.jsx)(c.Z,{variant:"tertiary",icon:k.Z,icon_position:"left",on_click:x,children:a.cancelButton})]})]})}var P=t(91974),E=t(61890);function S(e){const{1:n}=(0,o.useReducer)((()=>({})),{}),t=(0,o.useRef)();t.current=(0,o.useContext)(i.Z)||{};const{hasError:r,hasSubmitError:u}=(0,o.useContext)(y.Z)||{};t.current.hasError=r,t.current.hasSubmitError=u,u&&(t.current.containerMode="edit");const{handleRemove:c,switchContainerMode:l,containerMode:a,isNew:d}=t.current,{mode:h,open:m,ariaLabel:v,onAnimationEnd:x,className:b,children:Z,openDelay:C=100,variant:g="outline",...j}=e,w=(0,o.useRef)(null!=m?m:a===h&&!d),R=(0,o.useRef)(!1),_=(0,o.useCallback)((e=>{w.current=e,n()}),[]);(0,o.useEffect)((()=>{R.current||(void 0!==m?_(m):w.current!==(a===h)&&(d?setTimeout((()=>{_(a===h)}),C):_(a===h)))}),[a,d,h,m,C,_]);const k=(0,o.useCallback)((e=>{t.current.hasSubmitError&&(null==l||l("edit"));var n,r,o,u,s,c;t.current.hasSubmitError||("opened"===e?null===(n=t.current)||void 0===n||null===(r=n.elementRef)||void 0===r||null===(o=r.current)||void 0===o||null===(u=o.focus)||void 0===u||u.call(o):window.requestAnimationFrame((()=>{try{var e;if(null===(e=document.activeElement)||void 0===e||!e.closest(".dnb-forms-iterate__element")){var n;const e=null===(n=t.current)||void 0===n?void 0:n.containerRef.current.querySelectorAll(".dnb-forms-iterate__element");e[e.length-1].focus()}}catch(r){}})));!w.current&&R.current&&(R.current=!1,null===(s=t.current)||void 0===s||null===(c=s.fulfillRemove)||void 0===c||c.call(s));null==x||x(e)}),[x,l]),N=(0,o.useCallback)((()=>{R.current=!0,null==c||c({keepItems:!0}),_(!1)}),[c,_]);return(0,f.jsx)(p.Provider,{value:{handleRemoveBlock:N},children:(0,f.jsx)(P.Z,{className:s()("dnb-forms-section-block",g&&`dnb-forms-section-block--variant-${g}`,d&&"dnb-forms-section-block--new",t.current.hasSubmitError&&"dnb-forms-section-block--error",b),open:w.current,onAnimationEnd:k,duration:450,keepInDOM:!0,children:(0,f.jsx)(E.Z,{className:"dnb-forms-section-block__inner",...j,element:"section","aria-label":v,children:Z})})})}S._supportsSpacingProps=!0;var M=S,A=t(85192),B=t(80215);function V(e){const{children:n,className:t,...r}=e||{};return(0,f.jsxs)(B.Z,{top:"medium",className:s()("dnb-forms-iterate-toolbar",t),...r,children:[(0,f.jsx)(A.Z,{space:0}),(0,f.jsx)(R.Z,{top:"x-small",gap:"large",children:n})]})}function I(e){return(0,f.jsx)(F,{toolbar:(0,f.jsx)(V,{children:(0,f.jsx)(N,{})}),...e})}function F(e){const n=(0,o.useContext)(i.Z),{containerMode:t,isNew:r}=null!=n?n:{},{children:u,className:c,title:l,titleWhenNew:a,toolbar:d,...h}=e||{},m=(0,o.useRef)(r);(0,o.useEffect)((()=>{"view"===t&&(m.current=!1)}),[r,t]);const v=m.current&&a?a:l,p=(0,o.useMemo)((()=>(0,g.F4)(v)),[v]);return(0,f.jsxs)(M,{mode:"edit",className:s()("dnb-forms-section-edit-block",c),ariaLabel:p,...h,children:[v&&(0,f.jsx)(j.Z,{size:"basis",children:v}),u,d]})}V._supportsSpacingProps=!0,I._supportsSpacingProps=!0,F._supportsSpacingProps=!0;var O=t(28352);function L(){const e=(0,o.useContext)(i.Z),{switchContainerMode:n}=null!=e?e:{},t=(0,v.Z)().IterateViewContainer,r=(0,o.useCallback)((()=>{null==n||n("edit")}),[n]);return(0,f.jsxs)(R.Z,{gap:"large",children:[(0,f.jsx)(c.Z,{variant:"tertiary",icon:O.Z,icon_position:"left",on_click:r,children:t.editButton}),(0,f.jsx)(Z,{text:t.removeButton})]})}function T(e){const{children:n,className:t,title:r,...u}=e||{},c=(0,o.useMemo)((()=>(0,g.F4)(r)),[r]);return(0,f.jsx)(M,{mode:"view",ariaLabel:c,className:s()("dnb-forms-section-view-block",t),...u,children:(0,f.jsxs)(E.Z,{children:[r&&(0,f.jsx)(j.Z,{size:"basis",children:r}),n,(0,f.jsx)(V,{children:(0,f.jsx)(L,{})})]})})}T._supportsSpacingProps=!0;var $=T;function q(e){const n=(0,o.useContext)(i.Z),{isNew:t}=null!=n?n:{};return(0,f.jsx)(F,{open:!t||void 0,...e})}q._supportsSpacingProps=!0;var z=q,D=t(95955),H=t.n(D),W=t(49118),X=t(91749);function G(e){const{data:n}=(0,W.Z)(e.id);return J(n,e)}function J(e,n){let{path:t,filter:r}=n;if(H().has(e,t)){const n=H().get(e,t);if(Array.isArray(n))return r?n.filter(r).length:n.length;if("object"==typeof n&&n)return r?Object.entries(n).filter(r).length:Object.keys(n).length}return NaN}function K(e){const{data:n}=(0,X.Z)(e.id);return J(n,e)}function Q(e){void 0===e&&(e=void 0);const{data:n}=(0,W.Z)(e);return{count:(0,o.useCallback)(((e,t)=>J(n,{path:e,filter:t})),[n])}}const U=m,Y=Z}}]);
//# sourceMappingURL=fbd799404c18fcb2ae70eec44ffa013fd390a19b-03afb128ceb0b903d034.js.map