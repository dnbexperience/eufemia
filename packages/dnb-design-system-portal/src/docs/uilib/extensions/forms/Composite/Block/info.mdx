---
showTabs: true
hideInMenu: true
---

## Description

`Composite.Block` lets you compose together blocks of fields and values to be reused in different contexts.

## Usage

```tsx
import { Composite, Field } from '@dnb/eufemia/extensions/forms'

const MyBlock = (props) => {
  return (
    <Composite.Block {...props}>
      <Field.PhoneNumber path="/phoneNumber" required />
    </Composite.Block>
  )
}
```

## Path support

Optionally you can define a path to the block component. Fields inside the block will get this path as a prefix of their own path. This makes it possible to reuse the same block component in different contexts.

```tsx
import { Composite, Form, Field } from '@dnb/eufemia/extensions/forms'

const MyBlock = (props) => {
  return (
    <Composite.Block {...props}>
      <Flex.Stack>
        <Field.Name.First path="/firstName" />
        <Field.Name.Last path="/lastName" />
      </Flex.Stack>
    </Composite.Block>
  )
}

render(
  <Form.Handler
    defaultData={{
      // MyBlock has a path="/nestedPath" and therefore it is nested in the data context
      nestedPath: {
        firstName: 'Thor',
        lastName: 'Odinson',
      },
    }}
  >
    <MyBlock path="/nestedPath" />
  </Form.Handler>,
)
```

## TypeScript support

You can optionally define what the props of the nested fields should accept:

```tsx
import { Composite, Form, Field } from '@dnb/eufemia/extensions/forms'
import type { Props as PhoneNumberProps } from '@dnb/eufemia/extensions/forms/Field/PhoneNumber'
import type { BlockProps } from '@dnb/eufemia/extensions/forms/Composite/Block'

const MyBlock = (
  props: BlockProps<{ phoneNumber?: PhoneNumberProps }>,
) => {
  return (
    <Composite.Block {...props}>
      <Field.Name.Last path="/phoneNumber" required />
    </Composite.Block>
  )
}

render(
  <Form.Handler>
    <MyBlock />
  </Form.Handler>,
)
```

## Overwrite props

It lets you overwrite all of the given props if needed by using `overwriteProps`:

```tsx
import { Composite, Form, Field } from '@dnb/eufemia/extensions/forms'

const MyBlock = (props) => {
  return (
    <Composite.Block {...props}>
      <Flex.Stack>
        <Field.Name.First path="/firstName" />
        <Field.Name.Last path="/lastName" required minLength={2} />
      </Flex.Stack>
    </Composite.Block>
  )
}

render(
  <Form.Handler>
    <MyBlock
      overwriteProps={{
        firstName: { path: '/firstName2' },
        lastName: { required: false, minLength: 0 },
      }}
    />
  </Form.Handler>,
)
```

## Schema support

You can also use a `schema` to define the properties of the nested fields:

```tsx
import {
  Composite,
  Form,
  Field,
  JSONSchema,
} from '@dnb/eufemia/extensions/forms'

const MyBlock = (props) => {
  return (
    <Composite.Block {...props}>
      <Field.PhoneNumber path="/phoneNumber" />
    </Composite.Block>
  )
}

const schema: JSONSchema = {
  type: 'object',
  properties: {
    myBlock: {
      type: 'object',
      properties: {
        phoneNumber: {
          type: 'string',
          pattern: '^[0-9]{10}$',
        },
      },
      required: ['phoneNumber'],
    },
  },
}

render(
  <Form.Handler schema={schema}>
    <MyBlock path="/myBlock" />
  </Form.Handler>,
)
```

## Snapshot testing of a composite block

One way to ensure a "contract" of what you expect a block to be outlined as, is to create a snapshot test:

```tsx
import { Form } from '@dnb/eufemia/extensions/forms'

it('MyBlock should match snapshot', () => {
  const generateSchemaRef = React.createRef()

  render(
    <Form.Handler>
      <Form.Tools.GenerateSchema generateRef={generateSchemaRef}>
        <MyBlock />
      </Form.Tools.GenerateSchema>
    </Form.Handler>,
  )

  const { schema } = generateSchemaRef.current()
  expect(schema).toMatchInlineSnapshot(`
    {
      "type": "object",
      "properties": {
        "firstName": {
          "type": "string",
          "pattern": "^[\\p{L}\\p{M} \\-]+$",
        },
        "lastName": {
          "type": "string",
          "minLength": 2,
          "pattern": "^[\\p{L}\\p{M} \\-]+$",
        },
      },
      "required": [
        "lastName",
      ],
    }
  `)
})
```
