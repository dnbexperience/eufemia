---
showTabs: true
---

## Description

`Field.Upload` is a wrapper for the [Upload](/uilib/components/upload/) component to make it easier to use inside a form.

```jsx
import { Field } from '@dnb/eufemia/extensions/forms'
render(<Field.Upload />)
```

There is a corresponding [Value.Upload](/uilib/extensions/forms/Value/Upload) component.

## The data and file format

The returned data is an array of objects containing a file object and a unique ID. The file object contains the file itself and some additional properties like an unique ID.

```tsx
{
  id: '1234',
  file: {
    name: 'file1.jpg',
    size: 1234,
    type: 'image/jpeg',
  },
  errorMessage: 'error message ...',
}
```

This data format will be returned by the `onChange` and the `onSubmit` event handlers.

## Validation

The `required` property will validate if there are valid files present. If there are files with an error, the validation will fail.

If there are invalid files, the `onSubmit` event will not be called and a validation error will be shown.

The `onChange` event handler will return an array with objects containing the file object and some additional properties â€“ regardless of the validity of the file.

For error handling of invalid files, you can refer to the [Upload](/uilib/components/upload/) component for more details.

## About the `value` and `path` property

The `path` property represents an array with an object described above:

```tsx
render(
  <Form.Handler defaultData={{ myFiles: files }}>
    <Field.Upload path="/myFiles" />
  </Form.Handler>,
)
```

The `value` property represents an array with an object described above:

```tsx
render(<Field.Upload value={files} />)
```

## About the `asyncFileHandler` property

The `asyncFileHandler` is an asynchronous callback function that takes newly added files as a parameter and returns a promise containing the processed files. The component will automatically handle loading states during the upload process. This feature is useful for tasks like uploading files to a virus checker, which returns a new file ID if the file passes the check. To indicate a failed upload, set the `errorMessage` on the specific file object with the desired message to display next to the file in the upload list.

```js
async function virusCheck(newFiles) {
  const promises = newFiles.map(async (file) => {
    const formData = new FormData()
    formData.append('file', file.file, file.file.name)

    return await fetch('/', { method: 'POST', body: formData })
      .then((response) => {
        if (response.ok) return response.json()
        throw new Error('Unable to upload this file')
      })
      .then((data) => {
        return {
          ...file,
          id: data.server_generated_id,
        }
      })
      .catch((error) => {
        return {
          ...file,
          errorMessage: error.message,
        }
      })
  })

  return await Promise.all(promises)
}
```
